<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Kivro • Premium</title>
    <meta name="description" content="Exclusive unblocked library.">

    <!-- PWA Meta -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">

    <!-- Icons -->
    <link id="apple-touch-icon" rel="apple-touch-icon" href="https://raw.githubusercontent.com/KAYAZzz/CNM-Games/main/onsigma67.png">
    <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/KAYAZzz/CNM-Games/main/Logoactual.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Manrope', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        void: '#050505',
                        panel: '#0f0f0f',
                        accent: {
                            DEFAULT: '#8b5cf6',
                            glow: '#a78bfa',
                        }
                    },
                    animation: {
                        'float': 'float 8s ease-in-out infinite',
                        'blob': 'blob 10s infinite',
                        'fade-up': 'fadeUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-15px)' },
                        },
                        blob: {
                            '0%': { transform: 'translate(0px, 0px) scale(1)' },
                            '33%': { transform: 'translate(30px, -50px) scale(1.1)' },
                            '66%': { transform: 'translate(-20px, 20px) scale(0.9)' },
                            '100%': { transform: 'translate(0px, 0px) scale(1)' },
                        },
                        fadeUp: {
                            '0%': { opacity: 0, transform: 'translateY(20px)' },
                            '100%': { opacity: 1, transform: 'translateY(0)' }
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap');

        body {
            background-color: #050505;
            color: #e4e4e7;
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior-y: none;
            overflow-x: hidden;
        }

        .liquid-bg {
            position: fixed; inset: 0; z-index: -2;
            background: #000;
            overflow: hidden;
        }
        
        .blob-1, .blob-2, .blob-3 {
            position: absolute;
            filter: blur(80px);
            opacity: 0.4;
            border-radius: 50%;
            animation: blob 20s infinite alternate;
        }
        
        .blob-1 { top: -10%; left: -10%; width: 50vw; height: 50vw; background: #4c1d95; }
        .blob-2 { bottom: -10%; right: -10%; width: 50vw; height: 50vw; background: #312e81; animation-delay: -5s; }
        .blob-3 { top: 40%; left: 40%; width: 30vw; height: 30vw; background: #701a75; animation-delay: -10s; opacity: 0.3; }

        .smooth-card {
            background: rgba(20, 20, 20, 0.4);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 28px;
            transition: all 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        .smooth-card:hover {
            transform: translateY(-8px) scale(1.02);
            background: rgba(40, 40, 40, 0.6);
            border-color: rgba(139, 92, 246, 0.4);
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.6), 0 0 30px rgba(139, 92, 246, 0.15);
        }

        .img-wrapper {
            border-radius: 24px;
            overflow: hidden;
            mask-image: -webkit-radial-gradient(white, black);
        }

        .nav-pill {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(16px);
            border-radius: 99px;
            padding: 5px;
            display: flex;
            gap: 4px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 10px 30px -5px rgba(0,0,0,0.3);
        }

        .nav-btn {
            padding: 10px 24px;
            border-radius: 99px;
            color: #a1a1aa;
            font-weight: 700;
            font-size: 13px;
            letter-spacing: 0.02em;
            transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        .nav-btn.active {
            background: #fff;
            color: #000;
            box-shadow: 0 4px 20px rgba(255, 255, 255, 0.25);
        }

        .modal-surface {
            background: rgba(15, 15, 15, 0.85);
            backdrop-filter: blur(32px);
            -webkit-backdrop-filter: blur(32px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 40px;
            box-shadow: 0 40px 80px -20px rgba(0, 0, 0, 0.9);
        }

        .liquid-input {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            transition: all 0.3s ease;
        }
        .liquid-input:focus {
            background: rgba(0, 0, 0, 0.5);
            border-color: rgba(139, 92, 246, 0.5);
            box-shadow: 0 0 0 4px rgba(139, 92, 246, 0.1);
            outline: none;
        }

        .status-dot {
            width: 8px; height: 8px; border-radius: 50%;
            background: #4ade80; box-shadow: 0 0 12px rgba(74, 222, 128, 0.6);
        }

        ::-webkit-scrollbar { width: 0px; background: transparent; }
    </style>
</head>
<body class="antialiased selection:bg-violet-500/30 selection:text-white overflow-hidden" id="main-body">

    <div class="liquid-bg">
        <div class="blob-1"></div>
        <div class="blob-2"></div>
        <div class="blob-3"></div>
    </div>

    <!-- SITE LOCK -->
    <div id="site-lock" class="fixed inset-0 z-[10000] bg-black flex flex-col items-center justify-center transition-all duration-700">
        <div class="absolute inset-0 overflow-hidden pointer-events-none">
            <div class="absolute top-1/4 left-1/4 w-96 h-96 bg-violet-600/20 rounded-full blur-[100px] animate-blob"></div>
            <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-indigo-600/20 rounded-full blur-[100px] animate-blob" style="animation-delay: -2s;"></div>
        </div>

        <div class="relative z-10 w-full max-w-sm p-8 text-center animate-fade-up">
            <div class="w-20 h-20 bg-white/5 rounded-[2rem] flex items-center justify-center mx-auto mb-8 shadow-2xl border border-white/10 animate-float">
                <img src="https://raw.githubusercontent.com/KAYAZzz/CNM-Games/main/Logoactual.png" class="w-12 h-12 rounded-xl opacity-80">
            </div>
            
            <h1 class="text-2xl font-bold text-white mb-2 tracking-tight">Kivro Premium</h1>
            <p class="text-xs text-zinc-500 mb-6 uppercase tracking-widest">Secure Access Required</p>

            <div class="bg-white/5 border border-white/10 rounded-3xl p-6 mb-8 text-left">
                <h4 class="text-[10px] font-bold text-zinc-500 uppercase mb-4 tracking-tighter">Pricing Plans</h4>
                <div class="space-y-3">
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-zinc-300">1 Day Access</span>
                        <span class="text-sm font-bold text-white">3€</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-zinc-300">7 Day Access</span>
                        <span class="text-sm font-bold text-white">7€</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-zinc-300">Lifetime Access</span>
                        <span class="text-sm font-bold text-violet-400">15€</span>
                    </div>
                </div>
                <div class="mt-4 pt-4 border-t border-white/5 text-center">
                    <p class="text-[9px] font-bold text-red-500/80 uppercase tracking-widest">Strict No Refund Policy</p>
                </div>
            </div>

            <div class="relative group">
                <input type="password" id="site-key-input" 
                    class="w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-6 text-center text-white text-lg tracking-[0.5em] placeholder-zinc-700 focus:outline-none focus:border-violet-500/50 focus:bg-white/10 transition-all shadow-lg"
                    placeholder="KEY">
            </div>

            <div id="site-key-error" class="mt-4 text-red-400 text-xs font-bold opacity-0 transition-opacity uppercase tracking-widest">ACCESS DENIED</div>
            
            <button onclick="unlockSite()" class="mt-6 w-full py-4 rounded-2xl bg-white text-black font-bold text-sm hover:bg-violet-100 transition-all shadow-xl">
                Initialize System
            </button>
        </div>
    </div>

    <!-- MAIN APP CONTENT -->
    <div id="app-content" class="opacity-0 scale-95 transition-all duration-700 blur-sm h-screen overflow-y-auto">
        <nav class="fixed top-0 left-0 right-0 z-50 bg-black/10 backdrop-blur-md border-b border-white/5">
            <div class="max-w-7xl mx-auto px-6 h-24 flex items-center justify-between">
                <div class="flex items-center gap-4 cursor-pointer" onclick="window.scrollTo({top:0, behavior:'smooth'})">
                    <img src="https://raw.githubusercontent.com/KAYAZzz/CNM-Games/main/Logoactual.png" class="w-10 h-10 rounded-2xl shadow-lg">
                </div>

                <div class="nav-pill hidden sm:flex absolute left-1/2 transform -translate-x-1/2">
                    <button class="nav-btn active" data-tab="Games">Library</button>
                    <button class="nav-btn" data-tab="Apps">Apps</button>
                    <button class="nav-btn" data-tab="Proxy">Proxy</button>
                    <button class="nav-btn" data-tab="Favs">Saved</button>
                </div>

                <div class="flex items-center gap-3">
                    <div class="hidden md:flex items-center gap-2 px-4 py-2 rounded-full bg-white/5 border border-white/5">
                        <div id="timer-dot" class="status-dot"></div>
                        <span id="header-timer" class="text-[10px] font-bold text-zinc-400 font-mono tracking-widest">--:--:--</span>
                    </div>
                    <button id="search-toggle" class="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center text-zinc-400">
                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
                    </button>
                </div>
            </div>

            <div id="search-bar" class="hidden absolute top-24 left-0 right-0 bg-black/80 backdrop-blur-2xl border-b border-white/5 p-6">
                <div class="max-w-3xl mx-auto">
                    <input type="text" id="global-search" placeholder="Search..." class="liquid-input w-full py-5 px-8 text-white text-lg">
                </div>
            </div>
        </nav>

        <main class="pt-36 pb-12 px-4 max-w-7xl mx-auto min-h-screen">
            <div class="text-center mb-16 fade-up">
                <div class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-white/5 border border-white/5 text-zinc-400 text-[10px] font-bold mb-6">
                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                    Status: System Secure
                </div>
                <h1 class="text-4xl md:text-6xl font-extrabold text-white mb-6 tracking-tight">Premium Library</h1>
                <p class="text-zinc-400 font-medium text-lg">Accessing <span id="item-count" class="text-white font-bold">0</span> applications.</p>
            </div>

            <div id="game-grid" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-6 sm:gap-8"></div>
        </main>
    </div>

    <script>
        const API_URL = "https://script.google.com/macros/s/AKfycbxEgIRNKug7X2GY6dl6G8l0eYvDWrheyTOm3b5vPHYwNyVnhGbMuvNnEO20Kz57NMjA/exec";
        const THUMB_BASE = "https://raw.githubusercontent.com/KAYAZzz/CNM-Games/main/Thumbnails/";
        const GITHUB_BASE = "https://raw.githack.com/HTML5GameArchive/gfiles/master/games/";
        
        let favorites = JSON.parse(localStorage.getItem('kivro_favs') || '[]');
        let currentTab = 'Games';
        let countdownInterval = null;

        // --- DEVICE & SESSION SECURITY ---
        function getDeviceId() {
            let id = localStorage.getItem('kivro_device_token');
            if (!id) {
                id = 'KIV-' + Math.random().toString(36).substr(2, 9) + '-' + Date.now().toString(36);
                localStorage.setItem('kivro_device_token', id);
            }
            return id;
        }

        async function unlockSite() {
            const input = document.getElementById('site-key-input');
            const error = document.getElementById('site-key-error');
            const btn = document.querySelector('#site-lock button');
            const key = input.value.trim();
            const deviceId = getDeviceId();

            if (!key) {
                showError("Enter Key");
                return;
            }

            btn.innerText = "VERIFYING...";
            btn.disabled = true;

            try {
                const response = await fetch(`${API_URL}?key=${encodeURIComponent(key)}&deviceId=${encodeURIComponent(deviceId)}`);
                const data = await response.json();

                if (data.valid) {
                    const session = {
                        key: key,
                        expiresAt: data.expiresAt,
                        isUnlimited: data.isUnlimited,
                        timestamp: Date.now()
                    };
                    localStorage.setItem('kivro_premium_session', JSON.stringify(session));
                    enterSystem(session);
                } else {
                    showError(data.message || "Invalid Access");
                }
            } catch (err) {
                showError("Server Error");
                console.error(err);
            } finally {
                btn.innerText = "Initialize System";
                btn.disabled = false;
            }

            function showError(msg) {
                error.innerText = msg;
                error.classList.remove('opacity-0');
                setTimeout(() => error.classList.add('opacity-0'), 3000);
            }
        }

        function enterSystem(session) {
            document.getElementById('site-lock').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('site-lock').style.display = 'none';
                document.getElementById('app-content').classList.remove('opacity-0', 'scale-95', 'blur-sm');
                document.getElementById('main-body').classList.remove('overflow-hidden');
                
                startGlobalTimer(session.expiresAt, session.isUnlimited);
                init();
            }, 500);
        }

        function startGlobalTimer(expiresAt, isUnlimited) {
            const timerEl = document.getElementById('header-timer');
            const dot = document.getElementById('timer-dot');
            
            if (isUnlimited) {
                timerEl.innerText = "LIFETIME ∞";
                dot.classList.add('bg-violet-400');
                return;
            }

            if (countdownInterval) clearInterval(countdownInterval);

            countdownInterval = setInterval(() => {
                const now = Date.now();
                const diff = expiresAt - now;

                if (diff <= 0) {
                    clearInterval(countdownInterval);
                    localStorage.removeItem('kivro_premium_session');
                    window.location.reload();
                    return;
                }

                const h = Math.floor(diff / 3600000);
                const m = Math.floor((diff % 3600000) / 60000);
                const s = Math.floor((diff % 60000) / 1000);

                timerEl.innerText = `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
                
                if (diff < 3600000) dot.style.backgroundColor = '#f87171'; // Red for last hour
            }, 1000);
        }

        // --- GAME DATA ---
        const gamesList = [
              { id: 5, title: "2048", category: "Puzzle", imgUrl: THUMB_BASE + "2048.png", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//2048/index.html" },
            { id: 7, title: "BTD4", category: "Strategy", imgUrl: THUMB_BASE + "BTD4.jpg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//btd4/index.html" },
            { id: 6, title: "Bitlife", category: "Simulation", imgUrl: THUMB_BASE + "Bitlife.webp", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//bitlife/index.html" },
            { id: 8, title: "Chess", category: "Strategy", imgUrl: THUMB_BASE + "chess.jpg", gameUrl: GITHUB_BASE + "chess/index.html" },
            { id: 9, title: "Cookie Clicker", category: "Clicker", imgUrl: THUMB_BASE + "Cookie-Clicker.jpg", gameUrl: GITHUB_BASE + "cookieclicker/index.html" },
            { id: 10, title: "Drive Mad", category: "Racing", imgUrl: THUMB_BASE + "Drive-Mad.jpg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//drivemad/index.html" },
            { id: 2, title: "Flappy Bird", category: "Arcade", imgUrl: THUMB_BASE + "Flappy-Bird.jpg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//flappybird/index.html" },
            { id: 3, title: "Geo Dash", category: "Rhythm", imgUrl: THUMB_BASE + "Geometry-Dash.webp", gameUrl: "https://geometryite.vercel.app/" },
            { id: 15, title: "Google Snake", category: "Arcade", imgUrl: THUMB_BASE + "Google-Snake.jpg", gameUrl: "https://raw.githack.com/KAYAZzz/kivro-library/main/Snake/index.html" },
            { id: 11, title: "Monkey Mart", category: "Simulation", imgUrl: THUMB_BASE + "Monkey-Mart.jpg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//monkeymart/index.html" },
            { id: 12, title: "PacMan", category: "Arcade", imgUrl: THUMB_BASE + "Pacman.jpg", gameUrl: GITHUB_BASE + "pacman/index.html" },
            { id: 1, title: "Retro Bowl", category: "Sports", imgUrl: THUMB_BASE + "Retro-Ball.webp", gameUrl: GITHUB_BASE + "retrobowl/index.html" },
            { id: 14, title: "Slope", category: "Runner", imgUrl: THUMB_BASE + "slope.png", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//Slope/index.html" },
            { id: 16, title: "Snow Battle", category: "Action", imgUrl: THUMB_BASE + "Snow-Battle.png", gameUrl: GITHUB_BASE + "snowbattle/index.html" },
            { id: 17, title: "Stack", category: "Puzzle", imgUrl: THUMB_BASE + "Stack.webp", gameUrl: GITHUB_BASE + "stack/index.html" },
            { id: 4, title: "Drift Boss", category: "Racing", imgUrl: THUMB_BASE + "Drift1.jpg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//DriftBoss/index.html" },
            { id: 18, title: "Subway Surfers", category: "Runner", imgUrl: THUMB_BASE + "Subway-Surfers.jpg", gameUrl: "https://raw.githack.com/testingherokuapp/subwaysurfer/main/index.html" },
            { id: 19, title: "Baldi's Basics", category: "Horror", imgUrl: THUMB_BASE + "BaldisBasics.webp", gameUrl: GITHUB_BASE + "baldisbasics/index.html" },
            { id: 20, title: "Dino Runner", category: "Arcade", imgUrl: THUMB_BASE + "Dino.jpg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//chromedino/index.html" },
            { id: 21, title: "Stickman Hook", category: "Action", imgUrl: THUMB_BASE + "stickman-hook.png", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//StickmanHook/index.html" },
            { id: 23, title: "Block Blast", category: "Puzzle", imgUrl: THUMB_BASE + "block-blast.jpeg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//blockblast/index.html" },
            { id: 24, title: "Merge Rot", category: "Puzzle", imgUrl: THUMB_BASE + "merge-rot.png", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//MergeRot/index.html" },
            { id: 25, title: "Hole.io", category: "Action", imgUrl: THUMB_BASE + "Hole.png", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//HoleIO/index.html" },
            { id: 26, title: "Sausage Flip", category: "Fun", imgUrl: THUMB_BASE + "sausage-flip.png", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//sausage-flip/index.html" },
            { id: 27, title: "YoHoHo.io", category: "IO", imgUrl: THUMB_BASE + "Yohoho.jpg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io/yohohoio/index.html" },
            { id: 28, title: "Mr.Bullet", category: "Puzzle", imgUrl: THUMB_BASE + "Bullet.jpg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//MrBullet/index.html" },
            { id: 29, title: "Impossible Quiz", category: "Puzzle", imgUrl: THUMB_BASE + "Impossible.png", gameUrl: "https://raw.githack.com/selenite-cc/selenite-old/main/theimpossiblequiz/index.html" },
            { id: 30, title: "Paper.io", category: "IO", imgUrl: THUMB_BASE + "paper-io.png", gameUrl: GITHUB_BASE + "paperio/index.html" },
            { id: 31, title: "Hill Climb", category: "Racing", imgUrl: THUMB_BASE + "HillClimb.png", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//HillClimbRacing/index.html" },
            { id: 34, title: "Bottle Flip", category: "Skill", imgUrl: THUMB_BASE + "bottleflip.png", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//BottleFlip2/index.html" },
            { id: 35, title: "Penalty Kicks", category: "Sports", imgUrl: THUMB_BASE + "penalty.jpg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//PenaltyKicks/index.html" },
            { id: 36, title: "Gun Spin", category: "Action", imgUrl: THUMB_BASE + "gunspin.png", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//Gunspin/index.html" },
            { id: 37, title: "SandBoxel", category: "Simulation", imgUrl: THUMB_BASE + "Sandboxel.png", gameUrl: "https://raw.githack.com/R74nCom/sandboxels/main/index.html" },
            { id: 38, title: "Ballistic", category: "Puzzle", imgUrl: THUMB_BASE + "ballistic.png", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//Ballistic/index.html" },
            { id: 39, title: "Stacktris", category: "Puzzle", imgUrl: THUMB_BASE + "stacktris.jpeg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//stacktris/index.html" },
            { id: 40, title: "Tomb of Mask", category: "Action", imgUrl: THUMB_BASE + "TofM.jpg", gameUrl: "https://raw.githack.com/HTML5GameArchive/gfiles/master/games/tombofthemask/index.html" },
            { id: 41, title: "Paper Plane", category: "Fun", imgUrl: THUMB_BASE + "Planef.jpg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//PaperFlight1/index.html" },
            { id: 42, title: "Curve Rush", category: "Action", imgUrl: THUMB_BASE + "curve-rush.webp", gameUrl: "https://curverush.com/curve-rush.embed" },
            { id: 43, title: "Burrito Bison", category: "Action", imgUrl: THUMB_BASE + "Bb.png", gameUrl: "https://burrito-bison-cnm.vercel.app/" },
            { id: 43, title: "Golf Orbit", category: "Sports", imgUrl: THUMB_BASE + "golf-orbit.png", gameUrl: "https://golf-orbit-k8ue.vercel.app/" },
            { id: 44, title: "Ragdoll Archers", category: "Action", imgUrl: THUMB_BASE + "ragdoll-archers.jpg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//Ragdoll-Archers/index.html" },
            { id: 45, title: "Helix Jump", category: "Arcade", imgUrl: THUMB_BASE + "HelixJ.webp", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//helixjump/index.html" },
            { id: 46, title: "PolyTrack", category: "Racing", imgUrl: THUMB_BASE + "Polyt.webp", gameUrl: "https://raw.githack.com/AnonymousBirb5100/polytrack/main/index.html" },
            { id: 47, title: "Gobble", category: "Fun", imgUrl: THUMB_BASE + "Gobble.png", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//Gobble/gobble/index.html" },
            { id: 48, title: "Swingo", category: "Fun", imgUrl: THUMB_BASE + "swingo.jpg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//Swingo/index.html" },
            { id: 49, title: "Spiral Roll", category: "Fun", imgUrl: THUMB_BASE + "Spiralr.png", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//spralr/index.html" },
            { id: 50, title: "Wordle", category: "Word", imgUrl: THUMB_BASE + "IMG_0829.jpeg", gameUrl: "https://wordle-actual.vercel.app" },
            { id: 51, title: "Unicycle Heroes", category: "Physics", imgUrl: THUMB_BASE + "IMG_0832.jpeg", gameUrl: "https://unicycleh.vercel.app" },
            { id: 52, title: "Sheep Sheep", category: "Puzzle", imgUrl: THUMB_BASE + "Sheep.jpeg", gameUrl: "https://ubgfun.github.io/puzzle/hell-tile/" },
            { id: 53, title: "Game In Game", category: "Meta", imgUrl: THUMB_BASE + "GameInsideGame.png", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//game-inside/index.html" },
            { id: 54, title: "Black Jack", category: "Card", imgUrl: THUMB_BASE + "Blackjack.png", gameUrl: "https://blackjack-self.vercel.app/" },
            { id: 55, title: "Raft Wars", category: "Action", imgUrl: THUMB_BASE + "Raftwars.jpg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//raft-war/index.html" },
            { id: 56, title: "Small World Cup", category: "Sports", imgUrl: THUMB_BASE + "Asworldc.jpg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//a-smallwc/index.html" },
            { id: 57, title: "BowMasters", category: "Action", imgUrl: THUMB_BASE + "IMG_0856.png", gameUrl: "https://wowksies-github-io.onrender.com//bowmasters/index.html" },
            { id: 58, title: "State.io", category: "Strategy", imgUrl: THUMB_BASE + "IMG_0862.png", gameUrl: "https://stateactual.vercel.app/rvvASMiM/1701b2232f8c4f7689394f229bda07d7/index.html" },
            { id: 59, title: "Day of Meat", category: "Defense", imgUrl: THUMB_BASE + "Deathofmeat.jpg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//DayOfMeat/index.html" },
            { id: 60, title: "Knife Hit", category: "Skill", imgUrl: THUMB_BASE + "Knifehit.png", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//knifehit/index.html" },
            { id: 61, title: "Solar Smash", category: "Simulation", imgUrl: THUMB_BASE + "IMG_0868.png", gameUrl: "https://wowksies-github-io.onrender.com//solar-smash/index.html" },
            { id: 62, title: "Bridge Race", category: "Fun", imgUrl: THUMB_BASE + "IMG_0870.jpeg", gameUrl: "https://wowksies-github-io.onrender.com//bridge-race/index.html" },
            { id: 63, title: "Papa's Pizzeria", category: "Cooking", imgUrl: THUMB_BASE + "papaspiz.webp", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//papsp/index.html" },
            { id: 64, title: "Little Alchemy", category: "Puzzle", imgUrl: THUMB_BASE + "littleA.png", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//little-alchemy/index.html" },
            { id: 65, title: "8 Ball Pool", category: "Sports", imgUrl: THUMB_BASE + "8ballpool.webp", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//pool-pixijs/index.html" },
            { id: 66, title: "Stealth Master", category: "Action", imgUrl: THUMB_BASE + "stealthmaster.jpg", gameUrl: "https://wowksies-github-io.onrender.com//stealth-master/index.html" },
            { id: 67, title: "Hide and Seek", category: "Fun", imgUrl: THUMB_BASE + "hideandseek.webp", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//hideandseek/8328750458724478102.playables.usercontent.goog/v/assets/index.html" },
            { id: 68, title: "Slice it All", category: "Fun", imgUrl: THUMB_BASE + "sliceitall.png", gameUrl: "https://wowksies-github-io.onrender.com//slice-it-all/index.html" },
            { id: 69, title: "Bus Out", category: "Puzzle", imgUrl: THUMB_BASE + "busout.webp", gameUrl: "https://gamesbun.github.io/busout-school/" },
            { id: 70, title: "Blumgi Racers", category: "Racing", imgUrl: THUMB_BASE + "br.webp", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//blumgir/index.html" },
            { id: 71, title: "Hills Of Steel", category: "Action", imgUrl: THUMB_BASE + "hills%20of%20steel.webp", gameUrl: "https://hillofsteele.vercel.app/" },
            { id: 72, title: "Rooftop Snipers", category: "Action", imgUrl: THUMB_BASE + "rooftop-snipers.webp", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//rooftopsnipers/index.html" },
            { id: 73, title: "Blumgi Ball", category: "Sports", imgUrl: THUMB_BASE + "blumgiball.webp", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//blumgiball/index.html" },
            { id: 74, title: "Draw Joust", category: "Action", imgUrl: THUMB_BASE + "IMG_0959.png", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//DrawJoustindex.html" },
            { id: 78, title: "Basket Legends", category: "Sports", imgUrl: THUMB_BASE + "IMG_0963.jpeg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//basketball-legends-main/index.html" },
            { id: 79, title: "Soccer Legends", category: "Sports", imgUrl: THUMB_BASE + "Football-Legends.jpg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io//football-legends/index.html" },
            { id: 76, title: "Crossy Road", category: "Fun", imgUrl: THUMB_BASE + "CrossyR.jpg", gameUrl: "https://wowksies-github-io.onrender.com//crossy-road/index.html" },
            { id: 77, title: "Getaway Shoot", category: "Action", imgUrl: THUMB_BASE + "IMG_0980.jpeg", gameUrl: "https://kivro-game-library-9d7913.gitlab.io/getaway-shootout/index.html" }
        ];

        const appsList = [
            { id: 1001, title: "BlackFlix", category: "App", gameUrl: "https://ixlgroupjam.lovable.app/", imgUrl: THUMB_BASE + "IMG_0988.jpeg" }
        ];

        // --- APP LOGIC ---
        function init() {
            renderGrid(gamesList);
            updateCount();
            setupTabs();
            setupSearch();
        }

        function renderGrid(items) {
            const grid = document.getElementById('game-grid');
            grid.innerHTML = '';
            
            items.forEach((item, index) => {
                const isFav = favorites.includes(item.id);
                const card = document.createElement('div');
                card.className = "smooth-card group cursor-pointer animate-fade-up";
                card.style.animationDelay = `${index * 30}ms`;

                card.onclick = () => window.open(item.gameUrl, '_blank');

                card.innerHTML = `
                    <div class="h-36 sm:h-40 relative img-wrapper bg-black/50 m-2">
                        <img src="${item.imgUrl}" loading="lazy" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" onerror="this.src='https://placehold.co/400x250/111/444?text=NULL'">
                        <div class="absolute bottom-2 left-2 flex items-center gap-2 bg-black/40 backdrop-blur-md px-3 py-1.5 rounded-full border border-white/5">
                            <div class="status-dot"></div>
                            <span class="text-[10px] font-bold text-white/90 uppercase tracking-widest">Stable</span>
                        </div>
                    </div>
                    <div class="px-5 pb-5 pt-2 flex justify-between items-start">
                        <div>
                            <h3 class="text-sm font-bold text-zinc-100 truncate max-w-[120px]">${item.title}</h3>
                            <p class="text-[10px] text-zinc-500 font-bold uppercase tracking-wide mt-0.5">${item.category}</p>
                        </div>
                        <button onclick="toggleFav(event, ${item.id})" class="text-zinc-600 hover:text-yellow-400 transition-colors ${isFav ? 'text-yellow-400' : ''}">
                            <svg class="w-5 h-5" fill="${isFav ? 'currentColor' : 'none'}" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/></svg>
                        </button>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function setupTabs() {
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.onclick = () => {
                    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentTab = btn.dataset.tab;
                    
                    if (currentTab === 'Proxy') {
                        window.open('https://kivroprox1.vercel.app', '_blank');
                        return;
                    }
                    filterGrid();
                }
            });
        }

        function setupSearch() {
            const toggle = document.getElementById('search-toggle');
            const bar = document.getElementById('search-bar');
            const input = document.getElementById('global-search');

            toggle.onclick = () => {
                bar.classList.toggle('hidden');
                if(!bar.classList.contains('hidden')) input.focus();
            };
            input.oninput = (e) => filterGrid(e.target.value);
        }

        function filterGrid(term = '') {
            const s = term.toLowerCase();
            const all = [...gamesList, ...appsList];
            const filtered = all.filter(item => {
                if(!item.title.toLowerCase().includes(s)) return false;
                if(currentTab === 'Favs') return favorites.includes(item.id);
                if(currentTab === 'Apps') return item.category === 'App';
                return item.category !== 'App';
            });
            renderGrid(filtered);
            updateCount(filtered.length);
        }

        function updateCount(n) {
            document.getElementById('item-count').innerText = n || gamesList.length;
        }

        window.toggleFav = (e, id) => {
            e.stopPropagation();
            if(favorites.includes(id)) favorites = favorites.filter(x => x !== id);
            else favorites.push(id);
            localStorage.setItem('kivro_favs', JSON.stringify(favorites));
            filterGrid();
        };

        // --- SESSION RESUME ---
        window.onload = () => {
            const session = JSON.parse(localStorage.getItem('kivro_premium_session'));
            if (session) {
                if (!session.isUnlimited && session.expiresAt < Date.now()) {
                    localStorage.removeItem('kivro_premium_session');
                } else {
                    enterSystem(session);
                }
            }
        };

        document.getElementById('site-key-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') unlockSite();
        });
    </script>
</body>
</html>
